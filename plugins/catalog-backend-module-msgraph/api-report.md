## API Report File for "@backstage/plugin-catalog-backend-module-msgraph"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { CatalogProcessor } from '@backstage/plugin-catalog-backend';
import { CatalogProcessorEmit } from '@backstage/plugin-catalog-backend';
import { Config } from '@backstage/config';
import { GroupEntity } from '@backstage/catalog-model';
import { LocationSpec } from '@backstage/catalog-model';
import { Logger } from 'winston';
import * as MicrosoftGraph from '@microsoft/microsoft-graph-types';
import * as msal from '@azure/msal-node';
import { UserEntity } from '@backstage/catalog-model';

// @public (undocumented)
export function defaultGroupTransformer(group: MicrosoftGraph.Group, groupPhoto?: string): Promise<GroupEntity | undefined>;

// @public (undocumented)
export function defaultOrganizationTransformer(organization: MicrosoftGraph.Organization): Promise<GroupEntity | undefined>;

// @public (undocumented)
export function defaultUserTransformer(user: MicrosoftGraph.User, userPhoto?: string): Promise<UserEntity | undefined>;

// @public (undocumented)
export type GroupTransformer = (group: MicrosoftGraph.Group, groupPhoto?: string) => Promise<GroupEntity | undefined>;

// @public
export const MICROSOFT_GRAPH_GROUP_ID_ANNOTATION = "graph.microsoft.com/group-id";

// @public
export const MICROSOFT_GRAPH_TENANT_ID_ANNOTATION = "graph.microsoft.com/tenant-id";

// @public
export const MICROSOFT_GRAPH_USER_ID_ANNOTATION = "graph.microsoft.com/user-id";

// @public (undocumented)
export class MicrosoftGraphClient {
    constructor(baseUrl: string, pca: msal.ConfidentialClientApplication);
    // (undocumented)
    static create(config: MicrosoftGraphProviderConfig): MicrosoftGraphClient;
    // (undocumented)
    getGroupMembers(groupId: string): AsyncIterable<GroupMember>;
    // (undocumented)
    getGroupPhoto(groupId: string, sizeId?: string): Promise<string | undefined>;
    // (undocumented)
    getGroupPhotoWithSizeLimit(groupId: string, maxSize: number): Promise<string | undefined>;
    // (undocumented)
    getGroups(query?: ODataQuery): AsyncIterable<MicrosoftGraph.Group>;
    // (undocumented)
    getOrganization(tenantId: string): Promise<MicrosoftGraph.Organization>;
    // (undocumented)
    getUserPhoto(userId: string, sizeId?: string): Promise<string | undefined>;
    // (undocumented)
    getUserPhotoWithSizeLimit(userId: string, maxSize: number): Promise<string | undefined>;
    // (undocumented)
    getUserProfile(userId: string): Promise<MicrosoftGraph.User>;
    // (undocumented)
    getUsers(query?: ODataQuery): AsyncIterable<MicrosoftGraph.User>;
    // (undocumented)
    requestApi(path: string, query?: ODataQuery): Promise<Response>;
    // (undocumented)
    requestCollection<T>(path: string, query?: ODataQuery): AsyncIterable<T>;
    // (undocumented)
    requestRaw(url: string): Promise<Response>;
}

// @public
export class MicrosoftGraphOrgReaderProcessor implements CatalogProcessor {
    constructor(options: {
        providers: MicrosoftGraphProviderConfig[];
        logger: Logger;
        groupTransformer?: GroupTransformer;
    });
    // (undocumented)
    static fromConfig(config: Config, options: {
        logger: Logger;
        groupTransformer?: GroupTransformer;
    }): MicrosoftGraphOrgReaderProcessor;
    // (undocumented)
    readLocation(location: LocationSpec, _optional: boolean, emit: CatalogProcessorEmit): Promise<boolean>;
}

// @public
export type MicrosoftGraphProviderConfig = {
    target: string;
    authority?: string;
    tenantId: string;
    clientId: string;
    clientSecret: string;
    userFilter?: string;
    groupFilter?: string;
};

// @public (undocumented)
export function normalizeEntityName(name: string): string;

// @public (undocumented)
export type OrganizationTransformer = (organization: MicrosoftGraph.Organization) => Promise<GroupEntity | undefined>;

// @public (undocumented)
export function readMicrosoftGraphConfig(config: Config): MicrosoftGraphProviderConfig[];

// @public (undocumented)
export function readMicrosoftGraphOrg(client: MicrosoftGraphClient, tenantId: string, options: {
    userFilter?: string;
    groupFilter?: string;
    groupTransformer?: GroupTransformer;
    logger: Logger;
}): Promise<{
    users: UserEntity[];
    groups: GroupEntity[];
}>;

// @public (undocumented)
export type UserTransformer = (user: MicrosoftGraph.User, userPhoto?: string) => Promise<UserEntity | undefined>;


// (No @packageDocumentation comment for this package)

```
